{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from \"react\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Card, CardContent, Typography, Link } from '@material-ui/core';\nimport StarRatings from 'react-star-ratings';\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport Button from \"@material-ui/core/Button\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport { DeleteEvent, Favourite } from \"../../apis/auth-api\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from './styles';\nimport { authenticated } from \"../../redux/actions/auth\";\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nvar API_HOST = process.env.API_HOST;\n\nfunction Alert(props) {\n  return __jsx(MuiAlert, _extends({\n    elevation: 6,\n    variant: \"filled\"\n  }, props));\n}\n\n_c = Alert;\nvar useStyles = makeStyles(function (theme) {\n  var _objectSpread2;\n\n  return _objectSpread(_objectSpread({}, commonStyles), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, theme.breakpoints.up('sm'), desktopStyles), _defineProperty(_objectSpread2, theme.breakpoints.between('xs', 'sm'), TabStyles), _defineProperty(_objectSpread2, theme.breakpoints.down('xs'), mobileStyles), _objectSpread2));\n});\n\nfunction EventCard(_ref) {\n  _s();\n\n  var data = _ref.data,\n      _ref$isAuthUser = _ref.isAuthUser,\n      isAuthUser = _ref$isAuthUser === void 0 ? false : _ref$isAuthUser,\n      _ref$showState = _ref.showState,\n      showState = _ref$showState === void 0 ? false : _ref$showState;\n  var dispatch = useDispatch();\n\n  var _React$useState = React.useState(data.saved),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isSaved = _React$useState2[0],\n      setisSaved = _React$useState2[1];\n\n  var _React$useState3 = React.useState(isSaved ? 1 : 0),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      eventStar = _React$useState4[0],\n      seteventStar = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      snackbar = _React$useState6[0],\n      setsnackbar = _React$useState6[1];\n\n  var _React$useState7 = React.useState(\"\"),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      snackbarMsg = _React$useState8[0],\n      setsnackbarMsg = _React$useState8[1];\n\n  var _React$useState9 = React.useState(\"success\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      snackbarType = _React$useState10[0],\n      setsnackbarType = _React$useState10[1];\n\n  var user = useSelector(function (state) {\n    return state.auth_user.user.id;\n  });\n  var userFavEvents = useSelector(function (state) {\n    return state.auth_user.userFavEvents;\n  });\n  var accessToken = useSelector(function (state) {\n    return state.auth_user.accessToken;\n  });\n  var userdetail = useSelector(function (state) {\n    return state.auth_user.user;\n  });\n  useEffect(function () {\n    isFavourite();\n  }, [userFavEvents]);\n  var router = useRouter();\n  var favPage = router.pathname.search('favourite') == -1 ? false : true;\n  var classes = useStyles();\n\n  var isFavourite = function isFavourite() {\n    if (userFavEvents && userFavEvents.includes(data.id)) {\n      console.log(userFavEvents, userFavEvents.includes(data.id));\n      setisSaved(1);\n      seteventStar(1);\n    }\n  };\n\n  var changeRating = function changeRating() {\n    console.log('clk');\n\n    if (!accessToken || accessToken == '') {\n      window.location.replace(\"/?signup=open\");\n    }\n\n    if (!isSaved && eventStar == 0) {\n      Favourite({\n        'type_id': data.id,\n        type: 'event',\n        'user_id': user,\n        'action': 'add'\n      }).then(function (response) {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Added to favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        }\n      });\n      seteventStar(1);\n      setisSaved(!isSaved);\n    } else {\n      Favourite({\n        'type_id': data.id,\n        type: 'event',\n        'user_id': user,\n        'action': 'remove'\n      }).then(function (response) {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Removed from favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n\n          if (favPage) {\n            document.getElementById('card_' + data.id).parentElement.remove();\n          }\n        }\n      });\n      seteventStar(0);\n      setisSaved(!isSaved);\n    }\n  };\n\n  var _React$useState11 = React.useState(null),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      anchorEl = _React$useState12[0],\n      setAnchorEl = _React$useState12[1];\n\n  var handleClick = function handleClick(event) {\n    setAnchorEl(event.currentTarget);\n  };\n\n  var handleClose = function handleClose() {\n    setAnchorEl(null);\n  };\n\n  var handleEdit = function handleEdit() {\n    router.push(\"/post/event/edit/\" + data.id);\n  };\n\n  var handleDelete = function handleDelete() {\n    DeleteEvent(data, data.id).then(function (response) {\n      if (response.error) {\n        setsnackbar(true);\n        setsnackbarMsg(\"There is some error.Please try again later\");\n        setsnackbarType(\"error\");\n      } else {\n        setsnackbar(true);\n        setsnackbarMsg(\"Deleted\");\n        setsnackbarType(\"success\");\n        location.reload();\n      }\n    });\n  };\n\n  var handlesnackbar = function handlesnackbar() {\n    setsnackbar(!snackbar);\n  };\n\n  return __jsx(Card, {\n    className: \"\".concat(classes.card, \" event__card\"),\n    id: \"card_\" + data.id\n  }, data.images.length > 0 && __jsx(Link, {\n    href: \"/events/item/\".concat(data.id)\n  }, __jsx(\"img\", {\n    src: \"\".concat(API_HOST, \"/generate-thumb/220/300/\").concat(data.images[0].absolute_path),\n    alt: \"\",\n    className: classes.image\n  })), __jsx(CardContent, {\n    className: isSaved ? \"\".concat(classes.cardInner, \" \").concat(classes.Orangecard, \" \") : \"\".concat(classes.cardInner)\n  }, __jsx(Snackbar, {\n    open: snackbar,\n    autoHideDuration: 6000,\n    onClose: handlesnackbar\n  }, __jsx(Alert, {\n    onClose: handlesnackbar,\n    severity: snackbarType\n  }, snackbarMsg)), __jsx(\"div\", {\n    className: classes.flex\n  }, __jsx(Typography, {\n    variant: \"h6\",\n    className: classes.title\n  }, data.title.length >= 25 && __jsx(Link, {\n    href: \"/events/item/\".concat(data.id)\n  }, data.title.substring(0, 25) + \"...\", \" \"), data.title.length < 25 && __jsx(Link, {\n    href: \"/events/item/\".concat(data.id)\n  }, data.title)), isAuthUser && __jsx(\"div\", null, __jsx(MoreVertIcon, {\n    \"aria-controls\": \"simple-menu\",\n    \"aria-haspopup\": \"true\",\n    onClick: handleClick\n  }), __jsx(Menu, {\n    id: \"simple-menu\",\n    anchorEl: anchorEl,\n    keepMounted: true,\n    open: Boolean(anchorEl),\n    onClose: handleClose\n  }, __jsx(MenuItem, {\n    onClick: handleEdit\n  }, \"Edit\"), __jsx(MenuItem, {\n    onClick: handleDelete\n  }, \"Delete\"))), !isAuthUser && isSaved ? __jsx(FavoriteIcon, {\n    style: {\n      color: 'var(--theme)'\n    },\n    onClick: changeRating,\n    id: data.id\n  }) : __jsx(FavoriteBorderIcon, {\n    style: {\n      color: 'var(--theme)'\n    },\n    onClick: changeRating,\n    id: data.id\n  })), isAuthUser ? data.active ? __jsx(Typography, {\n    color: \"success\",\n    variant: \"h6\",\n    className: classes.date\n  }, \"Active\") : __jsx(Typography, {\n    color: \"error\",\n    variant: \"h6\",\n    className: classes.date\n  }, \"Inactive\") : '', __jsx(\"div\", {\n    className: classes.flex\n  }, __jsx(Typography, {\n    className: classes.date\n  }, data.event_date)), __jsx(\"div\", {\n    className: classes.cardBody\n  }, data.university.name.length >= 25 && __jsx(Typography, {\n    className: classes.college\n  }, data.university.name.substring(0, 25) + \"...\", \" \"), data.university.name.length < 25 && __jsx(Typography, {\n    className: classes.college\n  }, data.university.name))));\n}\n\n_s(EventCard, \"H43AulYn0rxsC+U4YDnxTuyXRu4=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useRouter, useStyles];\n});\n\n_c2 = EventCard;\nexport default EventCard;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Alert\");\n$RefreshReg$(_c2, \"EventCard\");","map":{"version":3,"sources":["C:/Users/91911/Downloads/frontend/src/components/EventCard/index.js"],"names":["React","useEffect","makeStyles","Card","CardContent","Typography","Link","StarRatings","MoreVertIcon","Button","Menu","MenuItem","Snackbar","MuiAlert","DeleteEvent","Favourite","useRouter","useDispatch","useSelector","commonStyles","desktopStyles","mobileStyles","TabStyles","authenticated","FavoriteIcon","FavoriteBorderIcon","API_HOST","process","env","Alert","props","useStyles","theme","breakpoints","up","between","down","EventCard","data","isAuthUser","showState","dispatch","useState","saved","isSaved","setisSaved","eventStar","seteventStar","snackbar","setsnackbar","snackbarMsg","setsnackbarMsg","snackbarType","setsnackbarType","user","state","auth_user","id","userFavEvents","accessToken","userdetail","isFavourite","router","favPage","pathname","search","classes","includes","console","log","changeRating","window","location","replace","type","then","response","error","body","favEvents","favProducts","document","getElementById","parentElement","remove","anchorEl","setAnchorEl","handleClick","event","currentTarget","handleClose","handleEdit","push","handleDelete","reload","handlesnackbar","card","images","length","absolute_path","image","cardInner","Orangecard","flex","title","substring","Boolean","color","active","date","event_date","cardBody","university","name","college"],"mappings":"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","sourcesContent":["import React ,{useEffect} from \"react\";\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { Card, CardContent, Typography, Link } from '@material-ui/core'\r\nimport StarRatings from 'react-star-ratings'\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport { DeleteEvent , Favourite} from \"../../apis/auth-api\";\r\nimport { useRouter } from \"next/router\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from './styles'\r\nimport { authenticated } from \"../../redux/actions/auth\";\r\nimport FavoriteIcon from '@material-ui/icons/Favorite';\r\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\r\nconst API_HOST = process.env.API_HOST;\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\nconst useStyles = makeStyles(theme => ({\r\n  ...commonStyles,\r\n  [theme.breakpoints.up('sm')]: desktopStyles,\r\n  [theme.breakpoints.between('xs', 'sm')]: TabStyles,\r\n  [theme.breakpoints.down('xs')]: mobileStyles\r\n}))\r\n\r\nfunction EventCard({ data, isAuthUser = false, showState=false }) {\r\n  const dispatch = useDispatch();\r\n  const [isSaved, setisSaved] = React.useState(data.saved)\r\n  const [eventStar, seteventStar] = React.useState(isSaved ? 1 : 0)\r\n  const [snackbar, setsnackbar] = React.useState(false);\r\n  const [snackbarMsg, setsnackbarMsg] = React.useState(\"\");\r\n  const [snackbarType, setsnackbarType] = React.useState(\"success\");\r\n  const user = useSelector((state) => state.auth_user.user.id);\r\n  const userFavEvents = useSelector((state) => state.auth_user.userFavEvents);\r\n  const accessToken = useSelector((state) => state.auth_user.accessToken);\r\n  const userdetail = useSelector((state) => state.auth_user.user);\r\n\r\n    useEffect(() => {\r\n       isFavourite();\r\n    }, [userFavEvents])\r\n  const router = useRouter();\r\n  const favPage = router.pathname.search('favourite')==-1 ? false : true;\r\n\r\n  const classes = useStyles()\r\n\r\n  const isFavourite = () => {\r\n      if (userFavEvents && userFavEvents.includes(data.id)) {\r\n          console.log(userFavEvents,userFavEvents.includes(data.id))\r\n          setisSaved(1);\r\n          seteventStar(1);\r\n         \r\n      }\r\n    };\r\n  const changeRating = () => {\r\n    console.log('clk');\r\n    if (!accessToken || accessToken==''){\r\n      window.location.replace(\"/?signup=open\");\r\n    }\r\n   \r\n    if (!isSaved && eventStar == 0) {\r\n\r\n       Favourite({'type_id':data.id,type:'event','user_id':user,'action':'add'}).then((response) => {\r\n        if (response.error) {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"There is some error.Please try again later\");\r\n          setsnackbarType(\"error\");          \r\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents,response.body.favProducts));\r\n\r\n        } else {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"Added to favourites\");\r\n          setsnackbarType(\"success\");\r\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents,response.body.favProducts));\r\n\r\n         \r\n        }\r\n      });\r\n\r\n      seteventStar(1);\r\n      setisSaved(!isSaved);\r\n    } else {\r\n\r\n       Favourite({'type_id':data.id,type:'event','user_id':user,'action':'remove'}).then((response) => {\r\n       \r\n        if (response.error) {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"There is some error.Please try again later\");\r\n          setsnackbarType(\"error\");       \r\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents,response.body.favProducts));\r\n        } else {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"Removed from favourites\");\r\n          setsnackbarType(\"success\");\r\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents,response.body.favProducts));\r\n          if(favPage){\r\n            document.getElementById('card_'+data.id).parentElement.remove();\r\n          }\r\n        }\r\n      });\r\n\r\n      seteventStar(0);\r\n      setisSaved(!isSaved);\r\n    }\r\n  };\r\n\r\n  const [anchorEl, setAnchorEl] = React.useState(null);\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n\r\n  const handleEdit = () => {\r\n    router.push(\"/post/event/edit/\" + data.id);\r\n  };\r\n  const handleDelete = () => {\r\n    DeleteEvent(data, data.id).then((response) => {\r\n      if (response.error) {\r\n        setsnackbar(true);\r\n        setsnackbarMsg(\"There is some error.Please try again later\");\r\n        setsnackbarType(\"error\");\r\n      } else {\r\n        setsnackbar(true);\r\n        setsnackbarMsg(\"Deleted\");\r\n        setsnackbarType(\"success\");\r\n        location.reload();\r\n      }\r\n    });\r\n  };\r\n\r\n\r\n  \r\n  const handlesnackbar = () => {\r\n    setsnackbar(!snackbar);\r\n  };\r\n\r\n\r\n  return (\r\n    <Card className={`${classes.card} event__card`} id={\"card_\"+data.id}>\r\n      {/* <img src={data.image.url} alt=\"\" className={classes.image} /> */}\r\n      {data.images.length > 0 && (\r\n        <Link href={`/events/item/${data.id}`}>\r\n          <img\r\n            src={`${API_HOST}/generate-thumb/220/300/${data.images[0].absolute_path}`}\r\n            alt=\"\"\r\n            className={classes.image}\r\n          />\r\n        </Link>\r\n      )}\r\n      <CardContent\r\n        className={\r\n          isSaved\r\n            ? `${classes.cardInner} ${classes.Orangecard} `\r\n            : `${classes.cardInner}`\r\n        }\r\n      >\r\n             <Snackbar\r\n            open={snackbar}\r\n            autoHideDuration={6000}\r\n            onClose={handlesnackbar}\r\n          >\r\n            <Alert onClose={handlesnackbar} severity={snackbarType}>\r\n              {snackbarMsg}\r\n            </Alert>\r\n          </Snackbar>\r\n        <div className={classes.flex}>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            {data.title.length >= 25 && (\r\n              <Link href={`/events/item/${data.id}`}>\r\n                {data.title.substring(0, 25) + \"...\"}{\" \"}\r\n              </Link>\r\n            )}\r\n            {data.title.length < 25 && (\r\n              <Link href={`/events/item/${data.id}`}>{data.title}</Link>\r\n            )}\r\n          </Typography>\r\n\r\n          {isAuthUser && (\r\n\r\n            <div>\r\n\r\n              <MoreVertIcon\r\n                aria-controls=\"simple-menu\"\r\n                aria-haspopup=\"true\"\r\n                onClick={handleClick}\r\n              ></MoreVertIcon>\r\n              <Menu\r\n                id=\"simple-menu\"\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={handleClose}\r\n              >\r\n                <MenuItem onClick={handleEdit}>Edit</MenuItem>\r\n                <MenuItem onClick={handleDelete}>Delete</MenuItem>\r\n              </Menu>\r\n            </div>\r\n          )}\r\n          {!isAuthUser &&\r\n            isSaved ?    <FavoriteIcon style={{ color: 'var(--theme)' }} onClick={changeRating}  id={data.id} /> : \r\n            <FavoriteBorderIcon style={{ color: 'var(--theme)' }} onClick={changeRating}  id={data.id} />  }\r\n          \r\n          \r\n\r\n        </div>\r\n        {isAuthUser ?\r\n\r\n          data.active ? <Typography color=\"success\" variant=\"h6\" className={classes.date}>Active</Typography> : <Typography color=\"error\" variant=\"h6\" className={classes.date}>Inactive</Typography> :''}\r\n\r\n      \r\n        <div className={classes.flex}>\r\n          <Typography className={classes.date}>{data.event_date}</Typography>\r\n          {/* <Typography\r\n            className={\r\n              isSaved\r\n                ? `${classes.price} ${classes.Orangeprice} `\r\n                : `${classes.price}`\r\n            }\r\n          >\r\n            &#8377;{data.price}\r\n          </Typography> */}\r\n        </div>\r\n        <div className={classes.cardBody}>\r\n          {/* <Typography className={classes.excerpt}>\r\n            {data.description.substring(0, 35) + \"...\"}{\" \"}\r\n          </Typography> */}\r\n          {data.university.name.length >= 25 && (\r\n            <Typography className={classes.college}>\r\n              {data.university.name.substring(0, 25) + \"...\"}{\" \"}\r\n            </Typography>\r\n          )}\r\n          {data.university.name.length < 25 && (\r\n            <Typography className={classes.college}>\r\n              {data.university.name}\r\n            </Typography>\r\n          )}\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default EventCard"]},"metadata":{},"sourceType":"module"}