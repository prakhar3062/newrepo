{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { getImageLinkFromUID } from '../helpers/file';\nexport var STATUS_PENDING = 0;\nexport var STATUS_SENT = 1;\nexport var STATUS_DELIVERED = 2;\nexport var STATUS_READ = 3;\nexport var GROUP_CHAT_ALERT_TYPE = {\n  CREATE: \"create\"\n};\nvar defaultMessage = {\n  id: '',\n  body: '',\n  dialog_id: '',\n  date_sent: Math.floor(Date.now() / 1000),\n  attachments: null,\n  sender_id: null,\n  sender: null\n};\nexport var Message = /*#__PURE__*/function () {\n  function Message() {\n    var msg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultMessage;\n    var currentUser = arguments.length > 1 ? arguments[1] : undefined;\n\n    _classCallCheck(this, Message);\n\n    this.id = msg.id || msg._id;\n    this.body = msg.body || msg.message;\n    this.group_chat_alert_type = msg.group_chat_alert_type || null;\n    this.dialog_id = msg.chat_dialog_id || msg.extension && msg.extension.dialog_id;\n    this.date_sent = msg.date_sent || msg.extension && msg.extension.date_sent || Math.floor(Date.now() / 1000);\n    this.send_state = Message.getSendState(msg, currentUser);\n    this.attachment = Message.getAttachment(msg);\n    this.sender_id = msg.sender_id || msg.extension && msg.extension.sender_id;\n    this.sender = msg.sender_id;\n  }\n\n  _createClass(Message, null, [{\n    key: \"getAttachment\",\n    value: function getAttachment(msg) {\n      var _msg$extension;\n\n      if (msg.attachments && msg.attachments.length > 0) {\n        var attachments = _objectSpread({}, msg.attachments[0]);\n\n        var parseLink = getImageLinkFromUID(msg.attachments[0].uid);\n        attachments.url = parseLink;\n        return [attachments];\n      } else if (msg !== null && msg !== void 0 && (_msg$extension = msg.extension) !== null && _msg$extension !== void 0 && _msg$extension.attachments && msg.extension.attachments.length > 0) {\n        var _attachments = _objectSpread({}, msg.extension.attachments[0]);\n\n        var _parseLink = getImageLinkFromUID(msg.extension.attachments[0].uid);\n\n        _attachments.url = _parseLink;\n        return [_attachments];\n      } else return null;\n    }\n  }, {\n    key: \"getSendState\",\n    value: function getSendState(msg, currentUser) {\n      var _msg$read_ids, _msg$delivered_ids;\n\n      if (msg !== null && msg !== void 0 && (_msg$read_ids = msg.read_ids) !== null && _msg$read_ids !== void 0 && _msg$read_ids.find(function (_id) {\n        return _id !== currentUser;\n      })) {\n        return STATUS_READ;\n      }\n\n      if (msg !== null && msg !== void 0 && (_msg$delivered_ids = msg.delivered_ids) !== null && _msg$delivered_ids !== void 0 && _msg$delivered_ids.find(function (msg) {\n        return msg.delivered_ids !== currentUser;\n      })) {\n        return STATUS_DELIVERED;\n      }\n\n      return STATUS_PENDING;\n    }\n  }]);\n\n  return Message;\n}();\nexport var FakeMessage = function FakeMessage(msg) {\n  _classCallCheck(this, FakeMessage);\n\n  this.attachment = msg.extension.attachments;\n  this.body = msg.body;\n  this.date_sent = msg.extension.date_sent;\n  this.dialog_id = msg.extension.dialog_id;\n  this.id = msg.id;\n  this.send_state = 0;\n  this.sender = undefined;\n  this.sender_id = msg.extension.sender_id;\n};","map":{"version":3,"sources":["C:/Users/91911/Downloads/frontend/src/redux/models/message.js"],"names":["getImageLinkFromUID","STATUS_PENDING","STATUS_SENT","STATUS_DELIVERED","STATUS_READ","GROUP_CHAT_ALERT_TYPE","CREATE","defaultMessage","id","body","dialog_id","date_sent","Math","floor","Date","now","attachments","sender_id","sender","Message","msg","currentUser","_id","message","group_chat_alert_type","chat_dialog_id","extension","send_state","getSendState","attachment","getAttachment","length","parseLink","uid","url","read_ids","find","delivered_ids","FakeMessage","undefined"],"mappings":"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","sourcesContent":["import { getImageLinkFromUID } from '../helpers/file'\n\nexport const STATUS_PENDING = 0\nexport const STATUS_SENT = 1\nexport const STATUS_DELIVERED = 2\nexport const STATUS_READ = 3\n\nexport const GROUP_CHAT_ALERT_TYPE = {\n  CREATE: \"create\"\n}\n\nconst defaultMessage = {\n  id: '',\n  body: '',\n  dialog_id: '',\n  date_sent: Math.floor(Date.now() / 1000),\n  attachments: null,\n  sender_id: null,\n  sender: null\n}\n\nexport class Message {\n  constructor(msg = defaultMessage, currentUser) {\n    this.id = msg.id || msg._id\n    this.body = msg.body || msg.message\n    this.group_chat_alert_type = msg.group_chat_alert_type || null\n    this.dialog_id = msg.chat_dialog_id || (msg.extension && msg.extension.dialog_id)\n    this.date_sent = msg.date_sent || (msg.extension && msg.extension.date_sent) || Math.floor(Date.now() / 1000)\n    this.send_state = Message.getSendState(msg, currentUser)\n    this.attachment = Message.getAttachment(msg)\n    this.sender_id = msg.sender_id || (msg.extension && msg.extension.sender_id)\n    this.sender = msg.sender_id\n  }\n\n  static getAttachment(msg) {\n    if (msg.attachments && msg.attachments.length > 0) {\n      const attachments = { ...msg.attachments[0] }\n      const parseLink = getImageLinkFromUID(msg.attachments[0].uid)\n      attachments.url = parseLink\n      return [attachments]\n    } else if (msg?.extension?.attachments && msg.extension.attachments.length > 0) {\n      const attachments = { ...msg.extension.attachments[0] }\n      const parseLink = getImageLinkFromUID(msg.extension.attachments[0].uid)\n      attachments.url = parseLink\n      return [attachments]\n    } else return null\n  }\n\n  static getSendState(msg, currentUser) {\n    if (msg?.read_ids?.find(_id => _id !== currentUser)) {\n      return STATUS_READ\n    }\n    if (msg?.delivered_ids?.find(msg => msg.delivered_ids !== currentUser)) {\n      return STATUS_DELIVERED\n    }\n    return STATUS_PENDING\n  }\n\n}\n\nexport class FakeMessage {\n  constructor(msg) {\n    this.attachment = msg.extension.attachments\n    this.body = msg.body\n    this.date_sent = msg.extension.date_sent\n    this.dialog_id = msg.extension.dialog_id\n    this.id = msg.id\n    this.send_state = 0\n    this.sender = undefined\n    this.sender_id = msg.extension.sender_id\n  }\n}"]},"metadata":{},"sourceType":"module"}