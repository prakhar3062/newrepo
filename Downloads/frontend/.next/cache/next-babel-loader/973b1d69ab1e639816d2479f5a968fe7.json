{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Card, CardContent, Typography, Link } from \"@material-ui/core\";\nimport StarRatings from \"react-star-ratings\";\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from \"./styles\";\nimport moment from \"moment\";\nimport BorderColorIcon from \"@material-ui/icons/BorderColor\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport Button from \"@material-ui/core/Button\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport MuiAlert from \"@material-ui/lab/Alert\";\nimport { DeleteProduct, Favourite } from \"../../apis/auth-api\";\nimport { authenticated } from \"../../redux/actions/auth\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\nvar API_HOST = process.env.API_HOST;\n\nfunction Alert(props) {\n  return __jsx(MuiAlert, _extends({\n    elevation: 6,\n    variant: \"filled\"\n  }, props));\n}\n\n_c = Alert;\nvar useStyles = makeStyles(function (theme) {\n  var _objectSpread2;\n\n  return _objectSpread(_objectSpread({}, commonStyles), {}, (_objectSpread2 = {}, _defineProperty(_objectSpread2, theme.breakpoints.up(\"sm\"), desktopStyles), _defineProperty(_objectSpread2, theme.breakpoints.between(\"xs\", \"sm\"), TabStyles), _defineProperty(_objectSpread2, theme.breakpoints.down(\"xs\"), mobileStyles), _objectSpread2));\n});\n\nfunction ProductCard(_ref) {\n  _s();\n\n  var data = _ref.data,\n      _ref$isAuthUser = _ref.isAuthUser,\n      isAuthUser = _ref$isAuthUser === void 0 ? false : _ref$isAuthUser;\n  var dispatch = useDispatch();\n\n  var _React$useState = React.useState(data.saved),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isSaved = _React$useState2[0],\n      setisSaved = _React$useState2[1];\n\n  var _React$useState3 = React.useState(isSaved ? 1 : 0),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      productStar = _React$useState4[0],\n      setproductStar = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      snackbar = _React$useState6[0],\n      setsnackbar = _React$useState6[1];\n\n  var _React$useState7 = React.useState(\"\"),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      snackbarMsg = _React$useState8[0],\n      setsnackbarMsg = _React$useState8[1];\n\n  var _React$useState9 = React.useState(\"success\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      snackbarType = _React$useState10[0],\n      setsnackbarType = _React$useState10[1];\n\n  var userdetail = useSelector(function (state) {\n    return state.auth_user.user;\n  });\n  var accessToken = useSelector(function (state) {\n    return state.auth_user.accessToken;\n  });\n  var user = useSelector(function (state) {\n    return state.auth_user.user.id;\n  });\n  var userFavProducts = useSelector(function (state) {\n    return state.auth_user.userFavProducts;\n  });\n  useEffect(function () {\n    isFavourite();\n  }, [userFavProducts]);\n  var classes = useStyles();\n  var router = useRouter();\n  var favPage = router.pathname.search(\"favourite\") == -1 ? false : true;\n\n  var changeRating = function changeRating() {\n    if (!accessToken || accessToken == \"\") {\n      window.location.replace(\"/?signup=open\");\n    }\n\n    if (!isSaved && productStar == 0) {\n      Favourite({\n        type_id: data.id,\n        type: \"product\",\n        user_id: user,\n        action: \"add\"\n      }).then(function (response) {\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          console.log(response.error);\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Added to favourites\");\n          setsnackbarType(\"success\");\n          console.log(userdetail, accessToken, response);\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n        }\n      });\n      setproductStar(1);\n      setisSaved(!isSaved);\n    } else {\n      Favourite({\n        type_id: data.id,\n        type: \"product\",\n        user_id: user,\n        action: \"remove\"\n      }).then(function (response) {\n        console.log(response);\n\n        if (response.error) {\n          setsnackbar(true);\n          setsnackbarMsg(\"There is some error.Please try again later\");\n          setsnackbarType(\"error\");\n          console.log(response.error);\n        } else {\n          setsnackbar(true);\n          setsnackbarMsg(\"Removed from favourites\");\n          setsnackbarType(\"success\");\n          dispatch(authenticated(userdetail, accessToken, response.body.favEvents, response.body.favProducts));\n\n          if (favPage) {\n            document.getElementById(\"card_\" + data.id).parentElement.remove();\n          }\n        }\n      });\n      setproductStar(0);\n      setisSaved(!isSaved);\n    }\n  };\n\n  var _React$useState11 = React.useState(null),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      anchorEl = _React$useState12[0],\n      setAnchorEl = _React$useState12[1];\n\n  var handleClick = function handleClick(event) {\n    setAnchorEl(event.currentTarget);\n  };\n\n  var handleClose = function handleClose() {\n    setAnchorEl(null);\n  };\n\n  var handleEdit = function handleEdit() {\n    router.push(\"/post/edit/\" + data.id);\n  };\n\n  var handleDelete = function handleDelete() {\n    DeleteProduct(data, data.id).then(function (response) {\n      if (response.error) {\n        setsnackbar(true);\n        setsnackbarMsg(\"There is some error.Please try again later\");\n        setsnackbarType(\"error\");\n      } else {\n        setsnackbar(true);\n        setsnackbarMsg(\"Deleted\");\n        setsnackbarType(\"success\");\n        location.reload();\n      }\n    });\n  };\n\n  var isFavourite = function isFavourite() {\n    if (userFavProducts && userFavProducts.includes(data.id)) {\n      console.log(userFavProducts, userFavProducts.includes(data.id));\n      setisSaved(true);\n      setproductStar(1);\n    }\n  };\n\n  var handlesnackbar = function handlesnackbar() {\n    setsnackbar(!snackbar);\n  };\n\n  return __jsx(Card, {\n    id: 'card_' + data.id,\n    className: isSaved ? \"\".concat(classes.card, \" \").concat(classes.Orangecard, \" \") : \"\".concat(classes.card)\n  }, __jsx(CardContent, {\n    className: classes.cardInner\n  }, __jsx(\"div\", {\n    className: classes.cardHead\n  }, __jsx(Snackbar, {\n    open: snackbar,\n    autoHideDuration: 6000,\n    onClose: handlesnackbar\n  }, __jsx(Alert, {\n    onClose: handlesnackbar,\n    severity: snackbarType\n  }, snackbarMsg)), __jsx(Typography, {\n    variant: \"h6\",\n    className: classes.title\n  }, data.title.length >= 25 && __jsx(Link, {\n    href: \"/products/item/\".concat(data.id)\n  }, data.title.substring(0, 25) + '...', ' '), data.title.length < 25 && __jsx(Link, {\n    href: \"/products/item/\".concat(data.id)\n  }, data.title)), isAuthUser && __jsx(\"div\", null, __jsx(MoreVertIcon, {\n    \"aria-controls\": \"simple-menu\",\n    \"aria-haspopup\": \"true\",\n    onClick: handleClick\n  }), __jsx(Menu, {\n    id: \"simple-menu\",\n    anchorEl: anchorEl,\n    keepMounted: true,\n    open: Boolean(anchorEl),\n    onClose: handleClose\n  }, __jsx(MenuItem, {\n    onClick: handleEdit\n  }, \"Edit\"), __jsx(MenuItem, {\n    onClick: handleDelete\n  }, \"Delete\"))), !isAuthUser && isSaved ? __jsx(FavoriteIcon, {\n    style: {\n      color: 'var(--theme)'\n    },\n    onClick: changeRating,\n    id: data.id\n  }) : __jsx(FavoriteBorderIcon, {\n    style: {\n      color: 'var(--theme)'\n    },\n    onClick: changeRating,\n    id: data.id\n  })), __jsx(\"div\", {\n    className: classes.cardBody\n  }, data.images.length > 0 && __jsx(Link, {\n    href: \"/products/item/\".concat(data.id)\n  }, __jsx(\"img\", {\n    src: \"\".concat(API_HOST, \"/generate-thumb/145/300/\").concat(data.images[0].absolute_path),\n    alt: \"\",\n    className: classes.image\n  }))), __jsx(\"div\", {\n    className: classes.cardFooter\n  }, __jsx(\"div\", {\n    className: classes.left\n  }, __jsx(Typography, {\n    className: classes.excerpt\n  }, data.description.substring(0, 35) + '...', ' '), data.university.name.length >= 25 && __jsx(Typography, {\n    className: classes.college\n  }, data.university.name.substring(0, 25) + '...', ' '), data.university.name.length < 25 && __jsx(Typography, {\n    className: classes.college\n  }, data.university.name)), __jsx(\"div\", {\n    className: classes.right\n  }, __jsx(Typography, {\n    className: isSaved ? \"\".concat(classes.price, \" \").concat(classes.Orangeprice, \" \") : \"\".concat(classes.price)\n  }, \"\\u20B9\", data.price), __jsx(Typography, {\n    className: classes.date\n  }, moment(data.created_at).format('MMMM D '))))));\n}\n\n_s(ProductCard, \"/lQAoJEx5ngC8T5xhNHtQijNAXM=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useStyles, useRouter];\n});\n\n_c2 = ProductCard;\nexport default ProductCard;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Alert\");\n$RefreshReg$(_c2, \"ProductCard\");","map":{"version":3,"sources":["C:/Users/91911/Downloads/frontend/src/components/ProductCard/index.js"],"names":["React","useEffect","makeStyles","Card","CardContent","Typography","Link","StarRatings","commonStyles","desktopStyles","mobileStyles","TabStyles","moment","BorderColorIcon","MoreVertIcon","Button","Menu","MenuItem","Snackbar","MuiAlert","DeleteProduct","Favourite","authenticated","useRouter","useDispatch","useSelector","FavoriteIcon","FavoriteBorderIcon","API_HOST","process","env","Alert","props","useStyles","theme","breakpoints","up","between","down","ProductCard","data","isAuthUser","dispatch","useState","saved","isSaved","setisSaved","productStar","setproductStar","snackbar","setsnackbar","snackbarMsg","setsnackbarMsg","snackbarType","setsnackbarType","userdetail","state","auth_user","user","accessToken","id","userFavProducts","isFavourite","classes","router","favPage","pathname","search","changeRating","window","location","replace","type_id","type","user_id","action","then","response","error","console","log","body","favEvents","favProducts","document","getElementById","parentElement","remove","anchorEl","setAnchorEl","handleClick","event","currentTarget","handleClose","handleEdit","push","handleDelete","reload","includes","handlesnackbar","card","Orangecard","cardInner","cardHead","title","length","substring","Boolean","color","cardBody","images","absolute_path","image","cardFooter","left","excerpt","description","university","name","college","right","price","Orangeprice","date","created_at","format"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport { Card, CardContent, Typography, Link } from \"@material-ui/core\";\r\nimport StarRatings from \"react-star-ratings\";\r\nimport { commonStyles, desktopStyles, mobileStyles, TabStyles } from \"./styles\";\r\nimport moment from \"moment\";\r\nimport BorderColorIcon from \"@material-ui/icons/BorderColor\";\r\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Menu from \"@material-ui/core/Menu\";\r\nimport MenuItem from \"@material-ui/core/MenuItem\";\r\nimport Snackbar from \"@material-ui/core/Snackbar\";\r\nimport MuiAlert from \"@material-ui/lab/Alert\";\r\nimport { DeleteProduct, Favourite } from \"../../apis/auth-api\";\r\nimport { authenticated } from \"../../redux/actions/auth\";\r\nimport { useRouter } from \"next/router\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport FavoriteIcon from \"@material-ui/icons/Favorite\";\r\nimport FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\r\nconst API_HOST = process.env.API_HOST;\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  ...commonStyles,\r\n  [theme.breakpoints.up(\"sm\")]: desktopStyles,\r\n  [theme.breakpoints.between(\"xs\", \"sm\")]: TabStyles,\r\n  [theme.breakpoints.down(\"xs\")]: mobileStyles,\r\n}));\r\n\r\nfunction ProductCard({ data, isAuthUser = false }) {\r\n  const dispatch = useDispatch();\r\n  const [isSaved, setisSaved] = React.useState(data.saved);\r\n  const [productStar, setproductStar] = React.useState(isSaved ? 1 : 0);\r\n  const [snackbar, setsnackbar] = React.useState(false);\r\n  const [snackbarMsg, setsnackbarMsg] = React.useState(\"\");\r\n  const [snackbarType, setsnackbarType] = React.useState(\"success\");\r\n  const userdetail = useSelector((state) => state.auth_user.user);\r\n  const accessToken = useSelector((state) => state.auth_user.accessToken);\r\n  const user = useSelector((state) => state.auth_user.user.id);\r\n  const userFavProducts = useSelector(\r\n    (state) => state.auth_user.userFavProducts\r\n  );\r\n\r\n  useEffect(() => {\r\n    isFavourite();\r\n  }, [userFavProducts]);\r\n\r\n  const classes = useStyles();\r\n  const router = useRouter();\r\n  const favPage = router.pathname.search(\"favourite\") == -1 ? false : true;\r\n\r\n  const changeRating = () => {\r\n    if (!accessToken || accessToken == \"\") {\r\n      window.location.replace(\"/?signup=open\");\r\n    }\r\n\r\n    if (!isSaved && productStar == 0) {\r\n      Favourite({\r\n        type_id: data.id,\r\n        type: \"product\",\r\n        user_id: user,\r\n        action: \"add\",\r\n      }).then((response) => {\r\n        if (response.error) {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"There is some error.Please try again later\");\r\n          setsnackbarType(\"error\");\r\n          console.log(response.error);\r\n        } else {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"Added to favourites\");\r\n          setsnackbarType(\"success\");\r\n          console.log(userdetail, accessToken, response);\r\n          dispatch(\r\n            authenticated(\r\n              userdetail,\r\n              accessToken,\r\n              response.body.favEvents,\r\n              response.body.favProducts\r\n            )\r\n          );\r\n        }\r\n      });\r\n\r\n      setproductStar(1);\r\n      setisSaved(!isSaved);\r\n    } else {\r\n      Favourite({\r\n        type_id: data.id,\r\n        type: \"product\",\r\n        user_id: user,\r\n        action: \"remove\",\r\n      }).then((response) => {\r\n        console.log(response);\r\n        if (response.error) {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"There is some error.Please try again later\");\r\n          setsnackbarType(\"error\");\r\n          console.log(response.error);\r\n        } else {\r\n          setsnackbar(true);\r\n          setsnackbarMsg(\"Removed from favourites\");\r\n          setsnackbarType(\"success\");\r\n          dispatch(\r\n            authenticated(\r\n              userdetail,\r\n              accessToken,\r\n              response.body.favEvents,\r\n              response.body.favProducts\r\n            )\r\n          );\r\n          if (favPage) {\r\n            document.getElementById(\"card_\" + data.id).parentElement.remove();\r\n          }\r\n        }\r\n      });\r\n\r\n      setproductStar(0);\r\n      setisSaved(!isSaved);\r\n    }\r\n  };\r\n\r\n  const [anchorEl, setAnchorEl] = React.useState(null);\r\n\r\n  const handleClick = (event) => {\r\n    setAnchorEl(event.currentTarget);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setAnchorEl(null);\r\n  };\r\n  const handleEdit = () => {\r\n    router.push(\"/post/edit/\" + data.id);\r\n  };\r\n  const handleDelete = () => {\r\n    DeleteProduct(data, data.id).then((response) => {\r\n      if (response.error) {\r\n        setsnackbar(true);\r\n        setsnackbarMsg(\"There is some error.Please try again later\");\r\n        setsnackbarType(\"error\");\r\n      } else {\r\n        setsnackbar(true);\r\n        setsnackbarMsg(\"Deleted\");\r\n        setsnackbarType(\"success\");\r\n        location.reload();\r\n      }\r\n    });\r\n  };\r\n\r\n  const isFavourite = () => {\r\n    if (userFavProducts && userFavProducts.includes(data.id)) {\r\n      console.log(userFavProducts, userFavProducts.includes(data.id));\r\n      setisSaved(true);\r\n      setproductStar(1);\r\n    }\r\n  };\r\n\r\n  const handlesnackbar = () => {\r\n    setsnackbar(!snackbar);\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      id={'card_' + data.id}\r\n      className={\r\n        isSaved ? `${classes.card} ${classes.Orangecard} ` : `${classes.card}`\r\n      }\r\n    >\r\n      <CardContent className={classes.cardInner}>\r\n        <div className={classes.cardHead}>\r\n          <Snackbar\r\n            open={snackbar}\r\n            autoHideDuration={6000}\r\n            onClose={handlesnackbar}\r\n          >\r\n            <Alert onClose={handlesnackbar} severity={snackbarType}>\r\n              {snackbarMsg}\r\n            </Alert>\r\n          </Snackbar>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            {data.title.length >= 25 && (\r\n              <Link href={`/products/item/${data.id}`}>\r\n                {data.title.substring(0, 25) + '...'}{' '}\r\n              </Link>\r\n            )}\r\n            {data.title.length < 25 && (\r\n              <Link href={`/products/item/${data.id}`}>{data.title}</Link>\r\n            )}\r\n          </Typography>\r\n          {isAuthUser && (\r\n            <div>\r\n              <MoreVertIcon\r\n                aria-controls=\"simple-menu\"\r\n                aria-haspopup=\"true\"\r\n                onClick={handleClick}\r\n              ></MoreVertIcon>\r\n              <Menu\r\n                id=\"simple-menu\"\r\n                anchorEl={anchorEl}\r\n                keepMounted\r\n                open={Boolean(anchorEl)}\r\n                onClose={handleClose}\r\n              >\r\n                <MenuItem onClick={handleEdit}>Edit</MenuItem>\r\n                <MenuItem onClick={handleDelete}>Delete</MenuItem>\r\n              </Menu>\r\n            </div>\r\n          )}\r\n          {!isAuthUser && isSaved ? (\r\n            <FavoriteIcon\r\n              style={{ color: 'var(--theme)' }}\r\n              onClick={changeRating}\r\n              id={data.id}\r\n            />\r\n          ) : (\r\n            <FavoriteBorderIcon\r\n              style={{ color: 'var(--theme)' }}\r\n              onClick={changeRating}\r\n              id={data.id}\r\n            />\r\n          )}\r\n        </div>\r\n        <div className={classes.cardBody}>\r\n          {data.images.length > 0 && (\r\n            <Link href={`/products/item/${data.id}`}>\r\n              <img\r\n                src={`${API_HOST}/generate-thumb/145/300/${data.images[0].absolute_path}`}\r\n                alt=\"\"\r\n                className={classes.image}\r\n              />\r\n            </Link>\r\n          )}\r\n        </div>\r\n        <div className={classes.cardFooter}>\r\n          <div className={classes.left}>\r\n            <Typography className={classes.excerpt}>\r\n              {data.description.substring(0, 35) + '...'}{' '}\r\n            </Typography>\r\n            {data.university.name.length >= 25 && (\r\n              <Typography className={classes.college}>\r\n                {data.university.name.substring(0, 25) + '...'}{' '}\r\n              </Typography>\r\n            )}\r\n            {data.university.name.length < 25 && (\r\n              <Typography className={classes.college}>\r\n                {data.university.name}\r\n              </Typography>\r\n            )}\r\n          </div>\r\n          <div className={classes.right}>\r\n            <Typography\r\n              className={\r\n                isSaved\r\n                  ? `${classes.price} ${classes.Orangeprice} `\r\n                  : `${classes.price}`\r\n              }\r\n            >\r\n              &#8377;{data.price}\r\n            </Typography>\r\n            <Typography className={classes.date}>\r\n              {moment(data.created_at).format('MMMM D ')}\r\n            </Typography>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n}\r\n\r\nexport default ProductCard;\r\n"]},"metadata":{},"sourceType":"module"}